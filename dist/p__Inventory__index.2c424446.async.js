(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[803],{78497:function(pe,G,n){"use strict";n.r(G),n.d(G,{default:function(){return he}});var M=n(28152),y=n.n(M),W=n(13448),o=n.n(W),Y=n(74815),D=n.n(Y),A=n(72902),Q=n(22818),b=n(82686),x=n(41874),q=n(33203),h=n(83258),_=n(41914),O=n(98630),X=n(73118),ee=n(10824),f=n(50959),re=n(53242),V=n.n(re),t=n(11527),ne=["xlsx"].map(function(C){return"."+C}).join(","),te=function(v){var l,p=(0,f.useState)({}),S=y()(p,2),a=S[0],R=S[1],N=(0,f.useState)(!0),E=y()(N,2),z=E[0],P=E[1],Z=v.checkData,F=v.actionRef,k=(l=(0,x.Ih)())===null||l===void 0?void 0:l.email,d=function(){var T=D()(o()().mark(function u(i){var j,c;return o()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return j=i.data,c=h.ZP.loading("\u0110ang nh\u1EADp v\xE9"),r.prev=2,r.next=5,(0,A.By)({data:j});case 5:return c(),h.ZP.success("\u0110\xE3 nh\u1EADp v\xE9 th\xE0nh c\xF4ng"),setTimeout(function(){window.location.reload()},1e3),r.abrupt("return",!0);case 11:return r.prev=11,r.t0=r.catch(2),c(),h.ZP.error("Nh\u1EADp v\xE9 kh\xF4ng th\xE0nh c\xF4ng"),window.location.reload(),r.abrupt("return",!1);case 17:case"end":return r.stop()}},u,null,[[2,11]])}));return function(i){return T.apply(this,arguments)}}(),w=function(){var u=new FileReader,i=!!u.readAsBinaryString;u.onload=function(){var j=D()(o()().mark(function c(s){var r,e,B,m,J,L,K;return o()().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:return r=s.target.result,e=V().read(r,{type:i?"binary":"array",bookVBA:!0}),B=e.SheetNames[0],m=e.Sheets[B],J=V().utils.sheet_to_json(m),L=[],J.forEach(function(g){var $=Z.find(function(fe){return fe.sku===g.Sku});$&&L.push({name:g["T\xEAn SP"],serial:g.Serial,code:g.Code,purchaseId:g.PurchaseId,activatedDate:g.ActivatedDate,expiredDate:g.ExpiredDate,importUser:k,groupTicket:$==null?void 0:$.id,state:"Pending"})}),I.next=9,d({data:L});case 9:K=I.sent,R({}),K&&F.current&&F.current.reload();case 12:case"end":return I.stop()}},c)}));return function(c){return j.apply(this,arguments)}}(),i?u.readAsBinaryString(a):u.readAsArrayBuffer(a)};return(0,t.jsxs)(_.Z,{children:[(0,t.jsx)(O.Z,{className:"form-control",accept:ne,maxCount:1,beforeUpload:function(u){var i=!1;return u.name.search(".xlsx")!==-1&&(i=!0),i?(R(u),P(!1)):h.ZP.error("".concat(u.name," Xin m\u1EDDi nh\u1EADp file Excel")),i||O.Z.LIST_IGNORE},onRemove:function(){return P(!0)},children:(0,t.jsx)(X.ZP,{icon:(0,t.jsx)(q.Z,{}),children:"Ch\u1ECDn File nh\u1EADp v\xE9"})}),(0,t.jsx)(ee.Z,{disabled:z,type:"submit",value:"Nh\u1EADp v\xE9",onClick:w})]})},ae=te,se=n(35245),ue=n(70024),ie=n(53830),le=n(14066),H=n(66060),de=n(90393),oe=n(79087),U={Delivered:{name:"\u0110\xE3 xu\u1EA5t",color:"red"},Pending:{name:"Ch\u01B0a xu\u1EA5t",color:"green"}},ce=function(){var C=D()(o()().mark(function v(l){var p;return o()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(p=h.ZP.loading("Deleting"),l){a.next=3;break}return a.abrupt("return",!0);case 3:if(a.prev=3,!(l.length>1)){a.next=9;break}return a.next=7,(0,A.qo)({key:l.map(function(R){return R._id})});case 7:a.next=11;break;case 9:return a.next=11,(0,A.RE)(l[0]);case 11:return p(),h.ZP.success("Deleted successfully and will refresh soon"),a.abrupt("return",!0);case 16:return a.prev=16,a.t0=a.catch(3),p(),h.ZP.error("Delete failed, please try again"),a.abrupt("return",!1);case 21:case"end":return a.stop()}},v,null,[[3,16]])}));return function(l){return C.apply(this,arguments)}}(),ve=function(){var v=(0,H.useRequest)(Q.Uu,{manual:!0,formatResult:function(r){return r.data}}),l=v.data,p=v.run,S=(0,H.useRequest)(b.ds,{manual:!0,formatResult:function(r){return r.data.map(function(e){return{sku:e.sku,id:e._id}})}}),a=S.data,R=S.run;(0,f.useEffect)(function(){p({current:1,pageSize:100}),R({current:1,pageSize:100,fields:"_id,sku"})},[]);var N=(0,f.useState)(!1),E=y()(N,2),z=E[0],P=E[1],Z=(0,f.useRef)(),F=(0,f.useState)(),k=y()(F,2),d=k[0],w=k[1],T=(0,f.useState)([]),u=y()(T,2),i=u[0],j=u[1],c=[{title:"S\u1EA3n ph\u1EA9m",dataIndex:"groupTicket",valueType:"cascader",fieldProps:{options:l&&(0,x.XV)(l),fieldNames:{children:"ticket",label:"field"},expandTrigger:"hover",changeOnSelect:!0,placeholder:"Ch\u1ECDn s\u1EA3n ph\u1EA9m"},search:{transform:function(r){return r.length===2?{groupTicket:r[1]}:{bigTicket:r}}},render:function(r,e){return(0,t.jsxs)("a",{onClick:function(){w(e),P(!0)},children:[(0,t.jsx)("div",{children:e.groupTicket.name}),(0,t.jsxs)("div",{children:[e.groupTicket.sku," - ",e.groupTicket.unit]})]})}},{title:"L\xF4 v\xE9 nh\u1EADp",hideInSearch:!0,render:function(r,e){return(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{children:[e.purchaseId," - ",e.importUser]}),(0,t.jsx)("div",{children:(0,x.Fc)(e.createdAt)})]})}},{title:"M\xE3 v\xE9",valueType:"text",render:function(r,e){return(0,t.jsx)("div",{children:(0,t.jsxs)("div",{children:["Serial: ",e.serial]})})},hideInSearch:!0},{title:"Hi\u1EC7u l\u1EF1c",hideInSearch:!0,render:function(r,e){return(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{children:(0,x._3)(e.activatedDate)}),(0,t.jsx)("div",{children:(0,x._3)(e.expiredDate)})]})}},{title:"Tr\u1EA1ng th\xE1i",dataIndex:"state",valueType:"select",valueEnum:{Delivered:"\u0110\xE3 xu\u1EA5t",Pending:"Ch\u01B0a xu\u1EA5t"},fieldProps:{placeholder:"Ch\u1ECDn tr\u1EA1ng th\xE1i v\xE9"},render:function(r,e){return(0,t.jsxs)("div",{children:[(0,t.jsx)(de.Z,{color:U[e.state].color,children:U[e.state].name},U[e.state].name),(0,t.jsx)("div",{children:e.issuedDate&&(0,x._3)(e.issuedDate)})]})}}];return(0,t.jsxs)(se._z,{children:[(0,t.jsx)(ue.Z,{pagination:{showSizeChanger:!0,showTotal:function(r){return"T\u1ED5ng ".concat(r," v\xE9")}},dateFormatter:"string",actionRef:Z,rowKey:"_id",search:{labelWidth:120,defaultCollapsed:!1,searchText:"T\xECm",resetText:"\u0110\u1EB7t l\u1EA1i",collapseRender:function(){return!0}},toolBarRender:function(){return[(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(ae,{checkData:a,actionRef:Z})})]},request:A.Ts,columns:c}),(i==null?void 0:i.length)>0&&(0,t.jsx)(ie.S,{children:(0,t.jsx)(X.ZP,{type:"primary",danger:!0,onClick:D()(o()().mark(function s(){var r,e;return o()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,ce(i);case 2:j([]),(r=Z.current)===null||r===void 0||(e=r.reloadAndRest)===null||e===void 0||e.call(r);case 4:case"end":return m.stop()}},s)})),children:"X\xF3a"})}),(0,t.jsx)(oe.Z,{width:600,open:z,onClose:function(){w(void 0),P(!1)},closable:!1,children:(d==null?void 0:d.name)&&(0,t.jsx)(le.vY,{column:2,title:d==null?void 0:d.name,request:D()(o()().mark(function s(){return o()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{data:d||{}});case 1:case"end":return e.stop()}},s)})),params:{id:d==null?void 0:d.name},columns:c})})]})},he=ve},51876:function(){},30210:function(){},65171:function(){},36171:function(){},53982:function(){}}]);
