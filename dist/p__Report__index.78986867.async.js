"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[307],{22818:function(K,O,e){e.d(O,{U0:function(){return I},Uu:function(){return L},gK:function(){return U},ik:function(){return r},kh:function(){return v},nM:function(){return b}});var y=e(13448),_=e.n(y),g=e(77117),l=e.n(g),C=e(74815),p=e.n(C),d=e(59183),h=e(66060);function L(t,n){return E.apply(this,arguments)}function E(){return E=p()(_()().mark(function t(n,a){return _()().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return A.abrupt("return",(0,h.request)("".concat("https://apa.vintrip.vn/api/v1","/bigTickets?sort=name"),l()({method:"GET",headers:{Authorization:"Bearer ".concat((0,d.v)())},params:l()({},n)},a||{})));case 1:case"end":return A.stop()}},t)})),E.apply(this,arguments)}function B(t){return m.apply(this,arguments)}function m(){return m=_asyncToGenerator(_regeneratorRuntime().mark(function t(n){return _regeneratorRuntime().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",request("".concat("https://apa.vintrip.vn/api/v1","/bigTickets/").concat(n==null?void 0:n.productId),_objectSpread({method:"GET",headers:{Authorization:"Bearer ".concat(getAuth())}},n||{})));case 1:case"end":return o.stop()}},t)})),m.apply(this,arguments)}function I(t){return D.apply(this,arguments)}function D(){return D=p()(_()().mark(function t(n){return _()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",(0,h.request)("".concat("https://apa.vintrip.vn/api/v1","/bigTickets/link"),{method:"POST",headers:{Authorization:"Bearer ".concat((0,d.v)())},data:l()({},n||{})}));case 1:case"end":return o.stop()}},t)})),D.apply(this,arguments)}function b(t){return P.apply(this,arguments)}function P(){return P=p()(_()().mark(function t(n){return _()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",(0,h.request)("".concat("https://apa.vintrip.vn/api/v1","/bigTickets/").concat(n==null?void 0:n.productId),{method:"PATCH",headers:{Authorization:"Bearer ".concat((0,d.v)()),"Content-Type":"multipart/form-data"},data:l()({},n||{})}));case 1:case"end":return o.stop()}},t)})),P.apply(this,arguments)}function U(t){return T.apply(this,arguments)}function T(){return T=p()(_()().mark(function t(n){return _()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",(0,h.request)("".concat("https://apa.vintrip.vn/api/v1","/bigTickets"),{method:"POST",headers:{Authorization:"Bearer ".concat((0,d.v)())},data:l()({},n||{})}));case 1:case"end":return o.stop()}},t)})),T.apply(this,arguments)}function v(t){return M.apply(this,arguments)}function M(){return M=p()(_()().mark(function t(n){return _()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",(0,h.request)("".concat("https://apa.vintrip.vn/api/v1","/bigTickets/").concat(n==null?void 0:n._id),{method:"DELETE",headers:{Authorization:"Bearer ".concat((0,d.v)())}}));case 1:case"end":return o.stop()}},t)})),M.apply(this,arguments)}function r(t){return u.apply(this,arguments)}function u(){return u=p()(_()().mark(function t(n){return _()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",(0,h.request)("".concat("https://apa.vintrip.vn/api/v1","/bigTickets/all"),{method:"POST",headers:{Authorization:"Bearer ".concat((0,d.v)())},data:l()({},n||{})}));case 1:case"end":return o.stop()}},t)})),u.apply(this,arguments)}},80223:function(K,O,e){e.d(O,{FK:function(){return v},Lh:function(){return L},Nq:function(){return B},cn:function(){return b},gQ:function(){return I},kX:function(){return U}});var y=e(13448),_=e.n(y),g=e(77117),l=e.n(g),C=e(74815),p=e.n(C),d=e(59183),h=e(66060);function L(r,u){return E.apply(this,arguments)}function E(){return E=p()(_()().mark(function r(u,t){return _()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,h.request)("".concat("https://apa.vintrip.vn/api/v1","/users"),l()({method:"GET",headers:{Authorization:"Bearer ".concat((0,d.v)())},params:l()({},u)},t||{})));case 1:case"end":return a.stop()}},r)})),E.apply(this,arguments)}function B(r){return m.apply(this,arguments)}function m(){return m=p()(_()().mark(function r(u){return _()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,h.request)("".concat("https://apa.vintrip.vn/api/v1","/users/").concat(u==null?void 0:u.userId),{method:"PATCH",headers:{Authorization:"Bearer ".concat((0,d.v)())},data:l()({},u||{})}));case 1:case"end":return n.stop()}},r)})),m.apply(this,arguments)}function I(r){return D.apply(this,arguments)}function D(){return D=p()(_()().mark(function r(u){return _()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,h.request)("".concat("https://apa.vintrip.vn/api/v1","/users/updateMyPassword"),{method:"PATCH",headers:{Authorization:"Bearer ".concat((0,d.v)())},data:l()({},u||{})}));case 1:case"end":return n.stop()}},r)})),D.apply(this,arguments)}function b(r){return P.apply(this,arguments)}function P(){return P=p()(_()().mark(function r(u){return _()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,h.request)("".concat("https://apa.vintrip.vn/api/v1","/users"),{method:"POST",headers:{Authorization:"Bearer ".concat((0,d.v)())},data:l()({},u||{})}));case 1:case"end":return n.stop()}},r)})),P.apply(this,arguments)}function U(r){return T.apply(this,arguments)}function T(){return T=p()(_()().mark(function r(u){return _()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,h.request)("".concat("https://apa.vintrip.vn/api/v1","/users/").concat(u==null?void 0:u._id),{method:"DELETE",headers:{Authorization:"Bearer ".concat((0,d.v)())}}));case 1:case"end":return n.stop()}},r)})),T.apply(this,arguments)}function v(r){return M.apply(this,arguments)}function M(){return M=p()(_()().mark(function r(u){return _()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,h.request)("".concat("https://apa.vintrip.vn/api/v1","/users/all"),{method:"POST",headers:{Authorization:"Bearer ".concat((0,d.v)())},data:l()({},u||{})}));case 1:case"end":return n.stop()}},r)})),M.apply(this,arguments)}},85144:function(K,O,e){e.d(O,{U:function(){return g}});var y=e(5726),_=e.n(y),g=[{label:"H\xF4m nay",value:[_()(),_()()]},{label:"H\xF4m qua",value:[_()().add(-1,"d"),_()().add(-1,"d")]},{label:"Tu\u1EA7n n\xE0y",value:[_()().startOf("week"),_()().endOf("week")]},{label:"Tu\u1EA7n tr\u01B0\u1EDBc",value:[_()().subtract(1,"weeks").startOf("week"),_()().subtract(1,"weeks").endOf("week")]},{label:"Th\xE1ng n\xE0y",value:[_()().startOf("month"),_()().endOf("month")]},{label:"Th\xE1ng tr\u01B0\u1EDBc",value:[_()().subtract(1,"months").startOf("month"),_()().subtract(1,"months").endOf("month")]}]},41874:function(K,O,e){e.d(O,{Fc:function(){return E},Ih:function(){return v},XV:function(){return P},Xy:function(){return D},_3:function(){return B},aS:function(){return m},bf:function(){return M},jX:function(){return T},pn:function(){return U},uO:function(){return I},z2:function(){return b}});var y=e(21320),_=e.n(y),g=e(77117),l=e.n(g),C=e(66060),p=e(5726),d=e.n(p),h=e(4895),L=e.n(h);function E(r){return d().locale("vi"),d()(r).format("DD/MM/YYYY, HH:mm")}function B(r){return d()(r).format("DD/MM/YYYY")}function m(r){var u=new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"});return u.format(r)}function I(r){var u=d()(r,"DD/MM/YYYY"),t=u.toISOString();return t}function D(r,u){var t={};return r.reduce(function(n,a){return l()(l()({},n),{},_()({},a[u],{text:a.label}))},t)}function b(r,u){var t={};return r.reduce(function(n,a){return l()(l()({},n),{},_()({},a[u],a.name))},t)}function P(r){var u={};return r.map(function(t){var n=t.groupTickets.map(function(a){return{field:"".concat(a.sku," - ").concat(a.name," - ").concat(a.unit),value:a._id}});return{field:t.name,value:t._id,ticket:n}},u)}function U(r){var u={};return r.map(function(t){var n=t.cashiers.map(function(a){return{label:"".concat(a.name," - ").concat(a.order),value:a._id}});return{label:t.name,options:n}},u)}function T(r){var u={};return r.map(function(t){return{label:t.name,phone:t.phone}},u)}function v(){var r=(0,C.useModel)("@@initialState"),u=r.initialState,t=u||{},n=t.currentUser;return n}var M={Adult:{name:"Ng\u01B0\u1EDDi l\u1EDBn"},Child:{name:"Tr\u1EBB em"},Elder:{name:"Ng\u01B0\u1EDDi cao tu\u1ED5i"}}},37609:function(K,O,e){e.r(O);var y=e(77117),_=e.n(y),g=e(13448),l=e.n(g),C=e(74815),p=e.n(C),d=e(28152),h=e.n(d),L=e(22818),E=e(80223),B=e(85144),m=e(41874),I=e(35245),D=e(70024),b=e(66060),P=e(1298),U=e(90393),T=e(73118),v=e(95034),M=e(5726),r=e.n(M),u=e(50959),t=e(68337),n=e(59183),a=e(11527),o=P.Z.Text,A={Finished:{name:"Ho\xE0n th\xE0nh",color:"Green"},Canceled:{name:"H\u1EE7y",color:"red"},Pending:{name:"Pending",color:"yellow"}},x={Adult:{name:"Ng\u01B0\u1EDDi l\u1EDBn"},Child:{name:"Tr\u1EBB em"},Elder:{name:"Ng\u01B0\u1EDDi cao tu\u1ED5i"}},F=function(){var V=(0,b.useModel)("@@initialState"),N=V.initialState,Z=N.departList,k=(0,u.useState)([]),w=h()(k,2),X=w[0],Q=w[1],Y=(0,b.useRequest)(E.Lh,{manual:!0,formatResult:function(i){return i.data.map(function(s){return{label:"".concat(s.name),value:s.email}})}}),z=Y.data,J=Y.run,$=(0,b.useRequest)(L.Uu,{manual:!0,formatResult:function(i){return i.data}}),G=$.data,q=$.run;(0,u.useEffect)(function(){J({current:1,pageSize:100}),q({current:1,pageSize:100})},[]);var ee=(0,u.useRef)(),ne=[{title:"Ng\xE0y xu\u1EA5t v\xE9",dataIndex:"updatedAt",valueType:"dateRange",hideInTable:!0,fieldProps:function(){return{format:"DD/MM/YYYY",presets:B.U,placeholder:["T\u1EEB ng\xE0y","\u0110\u1EBFn ng\xE0y"],defaultValue:[r()(),r()()]}},search:{transform:function(i){return{"updatedAt[gte]":(0,m.uO)(i[0]),"updatedAt[lte]":r()(i[1],"DD/MM/YYYY").add(1,"days").toISOString()}}},render:function(){return null}},{title:"T\xEAn ng\u01B0\u1EDDi xu\u1EA5t",dataIndex:"exportUser",valueType:"select",valueEnum:z&&(0,m.Xy)(z,"value"),fieldProps:{showSearch:!0,placeholder:"Ch\u1ECDn ng\u01B0\u1EDDi xu\u1EA5t v\xE9"}},{title:"\u0110\u1ECBa \u0111i\u1EC3m",dataIndex:"groupTicket",valueType:"cascader",fieldProps:{options:G&&(0,m.XV)(G),fieldNames:{children:"ticket",label:"field"},changeOnSelect:!0,placeholder:"Ch\u1ECDn \u0111\u1ECBa \u0111i\u1EC3m"},search:{transform:function(i){return i.length===2?{groupTicket:i[1]}:{bigTicket:i}}},render:function(i,s){return s.groupTicket.bigTicket.name}},{title:"Lo\u1EA1i v\xE9",hideInSearch:!0,render:function(i,s){return"".concat(s.groupTicket.name," - ").concat(x[s.groupTicket.unit].name)}},{title:"S\u1ED1 l\u01B0\u1EE3ng",hideInSearch:!0,render:function(i,s){return"".concat(s.quantity," x ").concat((0,m.aS)(s.price))}},{title:"T\u1ED5ng",dataIndex:"subTotal",hideInSearch:!0,renderText:function(i){return(0,m.aS)(i)}},{title:"Tr\u1EA1ng th\xE1i",dataIndex:"state",valueType:"select",valueEnum:{Finished:"Ho\xE0n th\xE0nh",Canceled:"H\u1EE7y",Pending:"Pending"},fieldProps:{placeholder:"Ch\u1ECDn tr\u1EA1ng th\xE1i",defaultValue:"Ho\xE0n Th\xE0nh"},render:function(i,s){return(0,a.jsx)("div",{children:(0,a.jsx)(U.Z,{color:A[s.state].color,children:A[s.state].name},A[s.state].name)})}},{title:"Qu\u1EA7y v\xE9",dataIndex:"departID",hideInTable:!0,valueType:"select",fieldProps:{options:(0,m.pn)(Z),placeholder:"Ch\u1ECDn qu\u1EA7y v\xE9"}}],te=[{title:"T\xEAn ng\u01B0\u1EDDi xu\u1EA5t",dataIndex:"exportUser"},{title:"\u0110\u1ECBa \u0111i\u1EC3m",dataIndex:"groupTicket",render:function(i,s){return s.groupTicket.bigTicket.name}},{title:"Lo\u1EA1i v\xE9",dataIndex:"unit",render:function(i,s){return"".concat(s.groupTicket.name," - ").concat(x[s.groupTicket.unit].name)}},{title:"S\u1ED1 l\u01B0\u1EE3ng",dataIndex:"quantity"},{title:"Gi\xE1",dataIndex:"price"},{title:"T\u1ED5ng",dataIndex:"subTotal"},{title:"Tr\u1EA1ng th\xE1i",dataIndex:"state",render:function(i,s){return A[s.state].name}}],re=function(){var c=p()(l()().mark(function i(){var s;return l()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,new t.i;case 2:s=f.sent,s.addSheet("Sheet").addColumns(te).addDataSource(X,{str2Percent:!0}).saveAs("Report-File.xlsx");case 4:case"end":return f.stop()}},i)}));return function(){return c.apply(this,arguments)}}();return(0,a.jsx)(I._z,{children:(0,a.jsx)(D.Z,{pagination:{pageSize:1e3},toolBarRender:function(){return[(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(T.ZP,{type:"primary",onClick:function(){return re()},children:"Xu\u1EA5t file"})})]},dateFormatter:"string",actionRef:ee,rowKey:"_id",search:{labelWidth:100,defaultCollapsed:!1,searchText:"T\xECm",resetText:"\u0110\u1EB7t l\u1EA1i",collapseRender:function(){return!0}},request:function(){var c=p()(l()().mark(function i(s,j){var f,S,W,R;return l()().wrap(function(H){for(;;)switch(H.prev=H.next){case 0:return f=s.state?"":"&state=Finished",S=s["updatedAt[gte]"]?"":"&updatedAt[gte]=".concat((0,m.uO)(r()().format("DD/MM/YYYY"))),W=s["updatedAt[lte]"]?"":"&updatedAt[lte]=".concat((0,m.uO)(r()().add(1,"day").format("DD/MM/YYYY"))),H.next=5,(0,b.request)("".concat("https://apa.vintrip.vn/api/v1","/orders/report?sort=updatedAt").concat(f).concat(S).concat(W),_()({method:"GET",headers:{Authorization:"Bearer ".concat((0,n.v)())},params:_()({},s)},j||{}));case 5:return R=H.sent,Q(R==null?void 0:R.data),H.abrupt("return",R);case 8:case"end":return H.stop()}},i)}));return function(i,s){return c.apply(this,arguments)}}(),columns:ne,summary:function(i){var s=0,j=0;return i.forEach(function(f){var S=f.subTotal,W=f.quantity,R=f.state;j+=R==="Finished"&&W,s+=R==="Finished"&&S}),(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)(v.Z.Summary.Row,{children:[(0,a.jsx)(v.Z.Summary.Cell,{index:0}),(0,a.jsx)(v.Z.Summary.Cell,{index:0}),(0,a.jsx)(v.Z.Summary.Cell,{index:0,children:"T\u1ED5ng c\u1ED9ng"}),(0,a.jsx)(v.Z.Summary.Cell,{index:0,children:(0,a.jsxs)(o,{type:"success",children:[j," v\xE9"]})}),(0,a.jsx)(v.Z.Summary.Cell,{index:0,children:(0,a.jsx)(o,{type:"success",children:(0,m.aS)(s)})})]})})}})})};O.default=F}}]);
